# api-definition.yaml
api:
  name: UserManagementAPI
  version: 1.0
  
entities:
  - name: User
    collection: users
    schema:
      - field: id
        type: string
        required: true
        unique: true
      - field: email
        type: string
        required: true
        unique: true
        validator: isEmail
      - field: passwordHash
        type: string
        required: true
      - field: role
        type: string
        enum: [admin, user]
        default: user
      - field: createdAt
        type: Date
        default: Date.now
    
  - name: Product
    collection: products
    schema:
      - field: id
        type: string
        required: true
        unique: true
      - field: name
        type: string
        required: true
      - field: price
        type: number
        required: true
      - field: stock
        type: number
        default: 0
      - field: category
        type: string
        required: true

endpoints:
  - path: /users
    controller: UserController
    operations:
      - method: GET
        auth: true
        role: admin
        service: UserService.findAll
      - method: POST
        auth: false
        service: UserService.create
        validation:
          - field: email
            rules: [required, email]
          - field: password
            rules: [required, minLength(8)]
  
  - path: /users/:id
    controller: UserController
    operations:
      - method: GET
        auth: true
        service: UserService.findById
      - method: PUT
        auth: true
        ownerOnly: true
        service: UserService.update
      - method: DELETE
        auth: true
        role: admin
        service: UserService.delete